{% extends "base.html" %}
{% load static %}
{% load crispy_forms_tags %}
{% crispy company_form %}
{% block header %}
{% endblock header %}

{% block content %}

<!-- Page-header start -->
<div class="col-sm-12">

    <div class="card">
        <div class="card-header">
            <h4 class="m-b-10">New Company</h4>
        </div>
        <div class="card-block">
            <p class="text-muted m-b-10">Register a new company here.</p>
        </div>
    </div>

</div>
<!-- Page-header end -->

<!-- Page-content start -->

<div class="col-sm-12">
    <div class="card">

        <div class="card-header">
            <div id="messageBox" style="display: none;">
                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                    <i class="icofont icofont-close-line-circled"></i>
                </button>

                <span></span>
            </div>
        </div>

        <div class="card-block">
        {% crispy companyForm %}
            {% comment %} <form id="companyForm" method="POST" enctype="multipart/form-data">
                {% csrf_token %}
                <!-- {{ companyForm|crispy }} -->
                <div class="form-row">
                    <div class="form-group col-md-4 mb-0">
                        {{ companyForm.name|as_crispy_field }}
                    </div>
                    <div class="form-group col-md-3 mb-0">
                        {{ companyForm.cnpj|as_crispy_field }}
                    </div>

                </div>
                <h4>Main Address</h4>
                <div class="form-row">
                    <div class="form-group col-md-4 mb-0">
                        {{ companyForm.line1|as_crispy_field }}
                    </div>
                    <div class="form-group col-md-3 mb-0">
                        {{ companyForm.line2|as_crispy_field }}
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group col-md-1 mb-0">
                        {{ companyForm.zipCode|as_crispy_field }}
                    </div>
                    <div class="form-group col-md-2 mb-0">
                        {{ companyForm.city|as_crispy_field }}
                    </div>
                    <div class="form-group col-md-2 mb-0">
                        {{ companyForm.state|as_crispy_field }}
                    </div>
                    <div class="form-group col-md-2 mb-0">
                        {{ companyForm.country|as_crispy_field }}
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group col-md-4 mb-0">
                        {{ companyForm.logo|as_crispy_field }}
                    </div>
                </div>

                <button type="submit" class="btn btn-primary">Register</button>
            </form> {% endcomment %}
        </div>
    </div>
</div>
<!-- Page-content end -->

{% endblock content %}

{% block scripts %}
<script src="{% static 'js/app.js' %}"></script>
<script src="{% static 'js/jquery.blockUI.js' %}"></script>
<script type="text/javascript">
    $(document).ajaxStop($.unblockUI);

    $(document).ready(function () {
        $("#companyForm").submit(function (e) {
            // prevent from normal form behaviour
            e.preventDefault();

            $.blockUI();
            // serialize the form data  
            var serializedData = $(this).serialize();
            createCompany(serializedData, '#companyForm', '#messageBox');

        });
    });
</script>
{% endblock scripts %}